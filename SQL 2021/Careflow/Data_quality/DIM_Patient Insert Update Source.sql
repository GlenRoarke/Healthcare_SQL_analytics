USE [HDM_Local]
GO

/****** Object:  StoredProcedure [Bamboo].[usp_Bamboo_DIM_PATIENT]    Script Date: 04/21/2021 09:56:49 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE procedure [Bamboo].[usp_Bamboo_DIM_PATIENT] @ExtractStartPeriod	DateTime, @ExtractEndPeriod 	DateTime 
AS BEGIN 
-- ===============================================================
-- Author:		Victoria Wood
-- Create date: May  1 2019  2:38PM
-- Name:	    [Bamboo].[usp_Bamboo_DIM_PATIENT]
-- Description: Retrieves all data between two dates
-- ===============================================================
 SELECT 
DIM_PATIENT_ID,
CREATE_DTTM,
MODIF_DTTM,
ARCHV_FLAG,
PATIENT_EXTERNAL_ID,
SURNAME,
FORENAME,
INITIALS,
DIM_LOOKUP_TITLE_ID,
TITLE_DESC,
TITLE_DESC5,
TITLE_NHSCODE,
TITLE_MAINCODE,
PAS_ID,
NHS_NUMBER,
DIM_LOOKUP_NNNST_ID,
NNNST_DESC,
NNNST_DESC5,
NNNST_NHSCODE,
NNNST_MAINCODE,
NHS_NUMBER_VERIFIED,
DIM_LOOKUP_SEX_ID,
SEX_DESC,
SEX_DESC5,
SEX_NHSCODE,
SEX_MAINCODE,
BIRTH_DTTM,
DOB_CONFM_FLAG,
DEATH_DTTM,
DIM_LOOKUP_DEATH_STATUS_ID,
DEATH_DESC,
DEATH_DESC5,
DEATH_NHSCODE,
DEATH_MAINCODE,
DEATH_REG_DTTM,
DIM_LOOKUP_CIVIL_STATE_ID,
CIVIL_DESC,
CIVIL_DESC5,
CIVIL_NHSCODE,
CIVIL_MAINCODE,
DIM_LOOKUP_OCCUPATION_ID,
OCCUP_DESC,
OCCUP_DESC5,
OCCUP_NHSCODE,
OCCUP_MAINCODE,
DIM_LOOKUP_ETHNIC_ORIGIN_ID,
ETHNC_DESC,
ETHNC_DESC5,
ETHNC_NHSCODE,
ETHNC_MAINCODE,
DIM_LOOKUP_RELIGION_ID,
RELGN_DESC,
RELGN_DESC5,
RELGN_NHSCODE,
RELGN_MAINCODE,
DIM_LOOKUP_FLANG_ID,
FLANG_DESC,
FLANG_DESC5,
FLANG_NHSCODE,
FLANG_MAINCODE,
INTERPRETER_FLAG,
ADDRESS1,
ADDRESS2,
ADDRESS3,
ADDRESS4,
ADDRESS5,
POSTCODE,
ADD_PCT,
HPHONE_NUMBER,
MPHONE_NUMBER,
EMAIL_ADDRESS,
DIM_HCP_ID,
HCP_TITLE,
HCP_FORENAME,
HCP_SURNAME,
HCP_MAINCODE,
DIM_HCO_ID,
HCO_NAME,
HCO_NHSCODE,
HCO_MAINCODE,
DIM_LOAD_ID,
DIM_TRUST_ID,
TRUST_REPORT_NAME,
TRUST_DESCRIPTION,
TRUST_CODE,
TRUST_LOCAL_CODE,
AUDIT_REFERENCE,
MERGE_RECORD_ID,
CASENOTE_IDENTIFIER,
HDM_MODIF_DTTM,
NOK_NAME,
DIM_LOOKUP_NOKREL_ID,
NOKREL_DESC,
NOKREL_DESC5,
NOKREL_NHSCODE,
NOKREL_MAINCODE,
NOK_HOME_PHONE_NO,
NOK_WORK_PHONE_NO,
REG_DTTM,
WPHONE_NUMBER,
DIM_LOOKUP_NAT_ID,
NAT_DESC,
NAT_DESC5,
NAT_NHSCODE,
NAT_MAINCODE,
PATIENT_LISTING_DESC,
ADDITIONAL_ID_1,
ADDITIONAL_ID_2,
ADDITIONAL_ID_3,
ADDITIONAL_ID_4,
ADDITIONAL_ID_5,
ADDITIONAL_ID_6,
ADDITIONAL_ID_7,
ADDITIONAL_ID_8,
ADDITIONAL_ID_9,
ADDITIONAL_ID_10,
ADDITIONAL_ID_11,
ADDITIONAL_ID_12,
MILITARY_VETERAN_FLAG,
HPHONE_NUMBER_CONSENT,
MPHONE_NUMBER_CONSENT,
EMAIL_ADDRESS_CONSENT,
WPHONE_NUMBER_CONSENT,
IN_UK_12MONTHS,
OVERSEAS_DETAILS,
EHI_INSTITUTIONID,
EHI_CARDID,
EHI_EXPIRYDATE,
IMAGE_ADDED_DTTM,
IMAGE_ADDED_DATE,
IMAGE_FLAG,
CARER_SUPPORT_INDICATOR,
CLOSED_DTTM,
DIM_CLOSED_BY_ID,
CLOSED_BY,
OTHER_LANGUAGE_DESC,
OTHER_LANGUAGE_CODE,
OTHER_LANGUAGE_DESC5,
DIM_LOOKUP_OTHER_LANGUAGE_ID,
OTHER_LANGUAGE_NHSCODE,
OTHER_LANGUAGE,
TEST_PAT_FLAG,
TEST_PAT_REASON,
SENSITIVE_LOCAL_FLAG,
SENSITIVE_PDS_FLAG,
PDS_SCN,
NOK_ADDRESS,
DIM_LOOKUP_ACCESS_NEEDS_ID,
ACCESS_NEEDS_DESC,
ACCESS_NEEDS_DESC5,
ACCESS_NEEDS_MAINCODE,
ACCESS_NEEDS_NHSCODE,
DIM_LOOKUP_VIS_IMPAIRMENT_ID,
VIS_IMPAIR_DESC,
VIS_IMPAIR_DESC5,
VIS_IMPAIR_MAINCODE,
VIS_IMPAIR_NHSCODE,
HIDDEN_FROM_SEARCH_FLAG,
PREFERRED_NAME

FROM [HDM].[dbo].DIM_PATIENT
WHERE [HDM_MODIF_DTTM] >= @ExtractStartPeriod AND [HDM_MODIF_DTTM] <= @ExtractEndPeriod
END

GO


